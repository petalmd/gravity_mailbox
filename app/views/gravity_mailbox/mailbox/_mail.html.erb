<div data-mail-id="<%= mail.message_id %>"
     class="card p-4 transition-all duration-200 cursor-pointer border-l-4 border-transparent"
     :class="id == '<%= mail.message_id %>' ? 'bg-base-200 border-l-4 border-secondary shadow-md' : 'hover:shadow-lg'"
     x-on:click="id = '<%= mail.message_id %>'">
  <div class="flex justify-between items-center mb-3">
    <div class="w-4/5 truncate">
      <span class="font-semibold text-base-content"><%= mail.subject %></span>
    </div>
    <div class="flex items-center">
      <div class="dropdown dropdown-end">
        <label tabindex="0" class="btn btn-ghost btn-sm btn-circle text-lg">
          <i class="bi bi-three-dots-vertical"></i>
        </label>
        <ul tabindex="0" class="dropdown-content menu shadow bg-base-100 w-52">
          <li>
            <%= link_to download_eml_path(id: mail.message_id) do %>
              <i class="bi bi-download"></i>
              <span>Download .eml</span>
            <% end %>
          </li>
          <li>
            <%= button_to delete_path(id: mail.message_id),
                          method: :post,
                          form_class: "block",
                          class: "w-full text-left",
                          onclick: "return confirm('Are you sure you want to delete this email?');" do %>
              <i class="bi bi-trash3"></i>
              <span>Delete</span>
            <% end %>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div class="space-y-1 mb-2">
    <% mail.to.each do |email_to| %>
      <p class="text-sm text-base-content/70"><%= email_to %></p>
    <% end %>
  </div>
  <div class="text-right">
    <span class="text-xs text-base-content/60" title="<%= I18n.l(mail.date, format: :long) %>">
      <%= time_ago_in_words(mail.date) %> ago
    </span>
  </div>
</div>
